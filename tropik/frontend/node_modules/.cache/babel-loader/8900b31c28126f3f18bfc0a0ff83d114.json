{"ast":null,"code":"var _jsxFileName = \"/opt/lampp/htdocs/myprojects/tropik/frontend/src/Components/Serveur/AnnexGReglements.jsx\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport axios from 'axios';\nimport { Button, TextField } from '@material-ui/core';\nimport { Link } from 'react-router-dom';\n\nclass AnnexGReglements extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      argentAjouter: ''\n    };\n  }\n\n  UpdateArgentRecu(e, reste) {\n    var stock = [];\n    console.log('argentAjouter:' + parseInt(this.state.argentAjouter) + ' reste:' + parseInt(reste));\n\n    if (parseInt(this.state.argentAjouter) < parseInt(reste)) {\n      stock = [{\n        NumReglement: e.NumReglement,\n        MontantReglement: parseInt(this.state.argentAjouter) + parseInt(e.MontantReglement),\n        EtatReglement: e.EtatReglement,\n        AnneeReglement: e.AnneeReglement\n      }];\n    } else {\n      stock = [{\n        NumReglement: e.NumReglement,\n        MontantReglement: parseInt(reste) + parseInt(e.MontantReglement),\n        EtatReglement: '1',\n        AnneeReglement: e.AnneeReglement\n      }];\n\n      if (parseInt(this.state.argentAjouter) - parseInt(reste) > 0) {\n        alert('donner ' + (parseInt(this.state.argentAjouter) - parseInt(reste)) + 'Ar au clients');\n      }\n    }\n\n    this.props.updateReglements(stock);\n    this.setState({\n      argentAjouter: ''\n    });\n  }\n\n  OnChangeUpdateArgentRecu(reste, e) {\n    // if((parseInt(reste)-parseInt(e.target.value))>=0){\n    this.setState({\n      argentAjouter: e.target.value\n    }); // }\n  }\n\n  MontantReservationReglement(NumReglement) {\n    var MontantReglement = 0;\n    const stock = this.props.reserver.dataReserver.filter(e => {\n      return e.NumReglement === NumReglement;\n    });\n\n    if (stock !== null && stock.length !== 0) {\n      const NameChambres = this.props.concerner.dataConcerner.filter(e => {\n        return e.NumReservation === stock[0].NumReservation;\n      });\n\n      if (NameChambres !== null && NameChambres.length !== 0) {\n        var prix = this.props.chambres.dataChambres.filter(e => {\n          return e.NomChambre === NameChambres[0].NomChambre;\n        });\n\n        if (prix !== null && prix.length !== 0) {\n          const date2 = new Date(stock[0].DateFinReservation);\n          const date1 = new Date(stock[0].DateDebutReservation);\n          MontantReglement = parseInt(prix[0].PrixChambre) * Math.round((date2 - date1) / (1000 * 3600 * 24));\n        } //\n\n      }\n    }\n\n    return MontantReglement;\n  }\n\n  reservationReglement(NumReglement) {\n    const stock = this.props.reserver.dataReserver.filter(e => {\n      return e.NumReglement === NumReglement;\n    });\n    return stock;\n  }\n\n  componentDidMount() {\n    if (this.props.reserver.dataReserver.length === 0) {\n      axios.get(\"http://localhost:80/myprojects/tropik/backend/Reservation/get\").then(res => res.data).then(state => this.props.fetchReserver(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n\n    if (this.props.concerner.dataConcerner.length === 0) {\n      axios.get(\"http://localhost:80/myprojects/tropik/backend/Concerner/get\").then(res => res.data).then(state => this.props.fetchConcerner(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n\n    if (this.props.chambres.dataChambres.length === 0) {\n      axios.get(\"http://localhost:80/myprojects/tropik/backend/Chambres/get\").then(res => res.data).then(state => this.props.fetchchambres(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n  }\n\n  render() {\n    const reste = this.MontantReservationReglement(this.props.data.NumReglement) - this.props.data.MontantReglement;\n    return React.createElement(\"div\", {\n      style: {\n        margin: 10,\n        display: 'flex',\n        justifyContent: 'space-between'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"Num: \", this.props.data.NumReglement, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), \"Montant Recu: \", this.props.data.MontantReglement, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }), \"Montant Rest: \", reste, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), \"Etat: \", this.props.data.EtatReglement, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }), \"Annee: \", this.props.data.AnneeReglement, this.reservationReglement(this.props.data.NumReglement).map(e => {\n      return React.createElement(\"div\", {\n        key: e.NumReservation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, \"Reservation: \", e.NumReservation, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }), \"Client: \", e.NumClient);\n    })), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, reste !== 0 ? React.createElement(\"div\", {\n      style: {\n        marginRight: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      type: \"number\",\n      onChange: this.OnChangeUpdateArgentRecu.bind(this, reste),\n      variant: \"outlined\",\n      value: this.state.argentAjouter,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), React.createElement(Button, {\n      size: \"small\",\n      variant: \"contained\",\n      style: {\n        marginTop: 5,\n        float: 'right'\n      },\n      onClick: () => this.UpdateArgentRecu(this.props.data, reste),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"ajouter\")) : React.createElement(\"div\", {\n      style: {\n        marginRight: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: 'Facture/' + e.NumReglement,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(Button, {\n      size: \"small\",\n      variant: \"contained\",\n      style: {\n        marginTop: 5,\n        float: 'right'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, \"Facturer\")))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    reserver: state.reserver,\n    chambres: state.chambres,\n    concerner: state.concerner\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    fetchchambres: data => {\n      dispatch({\n        type: \"FETCH_CHAMBRES\",\n        data: data\n      });\n    },\n    fetchReglements: data => {\n      dispatch({\n        type: \"FETCH_REGLEMENTS\",\n        data: data\n      });\n    },\n    fetchReserver: data => {\n      dispatch({\n        type: \"FETCH_RESERVER\",\n        data: data\n      });\n    },\n    fetchConcerner: data => {\n      dispatch({\n        type: \"FETCH_CONCERNER\",\n        data: data\n      });\n    },\n    updateReglements: data => {\n      dispatch({\n        type: \"UPDATE_REGLEMENTS\",\n        data: data\n      });\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnnexGReglements);","map":{"version":3,"sources":["/opt/lampp/htdocs/myprojects/tropik/frontend/src/Components/Serveur/AnnexGReglements.jsx"],"names":["React","Component","connect","axios","Button","TextField","Link","AnnexGReglements","constructor","props","state","argentAjouter","UpdateArgentRecu","e","reste","stock","console","log","parseInt","NumReglement","MontantReglement","EtatReglement","AnneeReglement","alert","updateReglements","setState","OnChangeUpdateArgentRecu","target","value","MontantReservationReglement","reserver","dataReserver","filter","length","NameChambres","concerner","dataConcerner","NumReservation","prix","chambres","dataChambres","NomChambre","date2","Date","DateFinReservation","date1","DateDebutReservation","PrixChambre","Math","round","reservationReglement","componentDidMount","get","then","res","data","fetchReserver","catch","err","fetchConcerner","fetchchambres","render","margin","display","justifyContent","map","NumClient","marginRight","bind","marginTop","float","mapStateToProps","mapDispatchToProps","dispatch","type","fetchReglements"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\nimport axios from 'axios';\nimport {Button, TextField} from '@material-ui/core';\nimport {Link} from 'react-router-dom';\n\nclass AnnexGReglements extends Component {\n  constructor(props){\n    super(props);\n    this.state={\n      argentAjouter: ''\n    }\n  }\n\n  UpdateArgentRecu(e, reste){\n    var stock = [];\n    console.log('argentAjouter:'+parseInt(this.state.argentAjouter) +' reste:'+ parseInt(reste))\n    if(parseInt(this.state.argentAjouter) < parseInt(reste)){\n      stock = [\n        {\n          NumReglement:e.NumReglement,\n          MontantReglement: parseInt(this.state.argentAjouter) + parseInt(e.MontantReglement),\n          EtatReglement: e.EtatReglement,\n          AnneeReglement: e.AnneeReglement\n        }\n      ]\n\n    }else{\n      stock = [\n        {\n          NumReglement:e.NumReglement,\n          MontantReglement: parseInt(reste) + parseInt(e.MontantReglement),\n          EtatReglement: '1',\n          AnneeReglement: e.AnneeReglement\n        }\n      ]\n      if((parseInt(this.state.argentAjouter) - parseInt(reste))>0){\n        alert('donner '+(parseInt(this.state.argentAjouter) - parseInt(reste))+'Ar au clients')\n      }\n    }\n    this.props.updateReglements(stock);\n    this.setState({\n      argentAjouter: ''\n    })\n  }\n\n  OnChangeUpdateArgentRecu(reste, e){\n    // if((parseInt(reste)-parseInt(e.target.value))>=0){\n      this.setState({\n        argentAjouter: e.target.value\n      })\n    // }\n  }\n\n  MontantReservationReglement(NumReglement){\n    var MontantReglement = 0;\n    const stock = this.props.reserver.dataReserver.filter(e=>{\n      return e.NumReglement === NumReglement;\n    });\n    if(stock !== null && stock.length !== 0){\n      const NameChambres = this.props.concerner.dataConcerner.filter(e=>{\n        return e.NumReservation === stock[0].NumReservation\n      });\n\n      if(NameChambres !== null && NameChambres.length !== 0){\n        var prix = this.props.chambres.dataChambres.filter(e=>{\n          return e.NomChambre === NameChambres[0].NomChambre;\n        });\n        if(prix!==null && prix.length !== 0){\n          const date2 = new Date(stock[0].DateFinReservation);\n          const date1 = new Date(stock[0].DateDebutReservation);\n          MontantReglement = parseInt(prix[0].PrixChambre) * (Math.round((date2 - date1) / (1000 * 3600 * 24)))\n        }\n        //\n      }\n    }\n    return MontantReglement;\n  }\n  reservationReglement(NumReglement){\n    const stock = this.props.reserver.dataReserver.filter(e=>{\n      return e.NumReglement === NumReglement;\n    });\n\n    return stock;\n  }\n  componentDidMount() {\n    if (this.props.reserver.dataReserver.length === 0) {\n      axios.get(\"http://localhost:80/myprojects/tropik/backend/Reservation/get\").then(res => res.data).then(state => this.props.fetchReserver(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n    if (this.props.concerner.dataConcerner.length === 0) {\n      axios.get(\"http://localhost:80/myprojects/tropik/backend/Concerner/get\").then(res => res.data).then(state => this.props.fetchConcerner(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n    if (this.props.chambres.dataChambres.length === 0) {\n      axios.get(\"http://localhost:80/myprojects/tropik/backend/Chambres/get\").then(res => res.data).then(state => this.props.fetchchambres(state)).catch(err => console.log(\"error parsing:\\n\", err));\n    }\n  }\n  render() {\n    const reste = this.MontantReservationReglement(this.props.data.NumReglement) - this.props.data.MontantReglement\n    return (\n      <div style={{margin: 10, display: 'flex', justifyContent: 'space-between'}}>\n        <div>\n        Num: {this.props.data.NumReglement}<br/>\n        Montant Recu: {this.props.data.MontantReglement}<br/>\n        Montant Rest: {reste}<br/>\n        Etat: {this.props.data.EtatReglement}<br/>\n        Annee: {this.props.data.AnneeReglement}\n        {\n          this.reservationReglement(this.props.data.NumReglement).map(e=>{\n            return <div key={e.NumReservation}>\n              Reservation: {e.NumReservation}<br/>\n              Client: {e.NumClient}\n            </div>;\n          })\n        }\n        </div>\n        <div>\n          {\n            reste!==0?\n            <div style={{marginRight: 20}} >\n              <TextField type='number' onChange={this.OnChangeUpdateArgentRecu.bind(this, reste)} variant=\"outlined\" value={this.state.argentAjouter} /><br/>\n              <Button\n                size='small'\n                variant=\"contained\"\n                style={{marginTop:5, float: 'right'}}\n                onClick={()=>this.UpdateArgentRecu(this.props.data, reste)}>\n                ajouter\n              </Button>\n          </div>:<div style={{marginRight: 20}} >\n            <Link to={'Facture/'+e.NumReglement}>\n              <Button\n                  size='small'\n                  variant=\"contained\"\n                  style={{marginTop:5, float: 'right'}}>\n                  Facturer\n              </Button>\n            </Link>\n          </div>\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {reserver: state.reserver, chambres: state.chambres, concerner: state.concerner}\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    fetchchambres: (data) => {\n      dispatch({type: \"FETCH_CHAMBRES\", data: data});\n    },\n    fetchReglements: (data) => {\n      dispatch({type: \"FETCH_REGLEMENTS\", data: data});\n    },\n    fetchReserver: (data) => {\n      dispatch({type: \"FETCH_RESERVER\", data: data});\n    },\n    fetchConcerner: (data) => {\n      dispatch({type: \"FETCH_CONCERNER\", data: data});\n    },\n    updateReglements: (data) => {\n      dispatch({type: \"UPDATE_REGLEMENTS\", data: data});\n    }\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AnnexGReglements);\n"]},"metadata":{},"sourceType":"module"}